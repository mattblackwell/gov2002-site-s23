<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2023-02-16">

<title>Gov 2002 - Gov 2002: Problem Set 4</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../files/img/gov2002-shield.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Gov 2002</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../syllabus.html">
 <span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../schedule.html">
 <span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../materials/index.html">
 <span class="menu-text">Materials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../assignments/index.html" aria-current="page">
 <span class="menu-text">Assignments</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://edstem.org/us/courses/31660/">
 <span class="menu-text">Ed</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.gradescope.com/courses/415456">
 <span class="menu-text">Gradescope</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Gov 2002: Problem Set 4</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Resources</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../assignments/index.html" class="sidebar-item-text sidebar-link">Assignments overview</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../assignments/problem-sets.html" class="sidebar-item-text sidebar-link">Problem set instructions</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Assignments</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../assignments/01_problem_set.html" class="sidebar-item-text sidebar-link">Problem Set 1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../assignments/02_problem_set.html" class="sidebar-item-text sidebar-link">Problem Set 2</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../assignments/03_problem_set.html" class="sidebar-item-text sidebar-link">Problem Set 3</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../assignments/04_problem_set.html" class="sidebar-item-text sidebar-link active">Problem Set 4</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../assignments/05_problem_set.html" class="sidebar-item-text sidebar-link">Problem Set 5</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#problem-set-instructions" id="toc-problem-set-instructions" class="nav-link active" data-scroll-target="#problem-set-instructions">Problem Set Instructions</a></li>
  <li><a href="#question-1-24-points" id="toc-question-1-24-points" class="nav-link" data-scroll-target="#question-1-24-points">Question 1 (24 points)</a></li>
  <li><a href="#question-2-20-points" id="toc-question-2-20-points" class="nav-link" data-scroll-target="#question-2-20-points">Question 2 (20 points)</a></li>
  <li><a href="#question-3-20-points" id="toc-question-3-20-points" class="nav-link" data-scroll-target="#question-3-20-points">Question 3 (20 points)</a></li>
  <li><a href="#question-4-fishers-method-in-forecasting-30-points" id="toc-question-4-fishers-method-in-forecasting-30-points" class="nav-link" data-scroll-target="#question-4-fishers-method-in-forecasting-30-points">Question 4: Fisher’s method in forecasting (30 points)</a></li>
  <li><a href="#question-5-6-points" id="toc-question-5-6-points" class="nav-link" data-scroll-target="#question-5-6-points">Question 5 (6 points)</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Gov 2002: Problem Set 4</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 16, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p><a href="../assignments/problem-sets.html">Submission instructions</a> | <a href="../files/assignments/pset_4.pdf">PDF <i class="fa-regular fa-file-pdf" aria-label="file-pdf"></i></a> | <a href="../files/assignments/pset_4.Rmd">Rmd <i class="fa-regular fa-file-code" aria-label="file-code"></i></a> |</p>
<section id="problem-set-instructions" class="level2">
<h2 class="anchored" data-anchor-id="problem-set-instructions">Problem Set Instructions</h2>
<p>This problem set is due on <strong>February 22, 11:59 pm</strong> Eastern time. Please upload a PDF of your solutions to Gradescope. We will accept hand-written solutions but we strongly advise you to typeset your answers in Rmarkdown. Please list the names of other students you worked with on this problem set.</p>
</section>
<section id="question-1-24-points" class="level2">
<h2 class="anchored" data-anchor-id="question-1-24-points">Question 1 (24 points)</h2>
<p>Suppose you’re interested in studying the distribution of political ideology in the US, a random variable that we’ll call <span class="math inline">\(X\)</span>. Individuals are placed on a continuous one-dimensional ideology scale that varies from -1 to 1, where lower score are more liberal. Instead of having to do sampling to estimate the distribution, Keith Poole comes to you in a dream and tells you the unnormalized distribution of this random variable, which is as follows:</p>
<p><span class="math display">\[
\begin{aligned}
f(x) = \begin{cases}
c(\frac{1}{2}x + 1) &amp; -1 \le x \le 1, \\
0 &amp; \text{else}
\end{cases}
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(c\)</span> is a normalizing constant.</p>
<ol type="a">
<li><p>Find the value of <span class="math inline">\(c\)</span> that would make <span class="math inline">\(f(x)\)</span> a valid probability distribution function, <span class="math inline">\(f_X(x)\)</span>.</p></li>
<li><p>Calculate <span class="math inline">\(E[X]\)</span>.</p></li>
<li><p>Find the cumulative density function of X.</p></li>
<li><p>Calculate <span class="math inline">\(P(X &gt; 0)\)</span>.</p></li>
</ol>
</section>
<section id="question-2-20-points" class="level2">
<h2 class="anchored" data-anchor-id="question-2-20-points">Question 2 (20 points)</h2>
<p>Let’s say you wanted to verify your answers to the above questions using simulation techniques. Since <span class="math inline">\(X\)</span> does not follow a standard probability distribution e.g.&nbsp;a normal, exponential, or uniform distribution, there is no function built in to R to generate random samples from it like <code>rnorm()</code>, <code>rexp()</code>, or <code>runif()</code>. Fortunately, we can generate samples from any probability distribution for which there is a closed-form CDF using what is called “inversion sampling” or “inverse transform sampling.”</p>
<p>To do this, we take advantage of two things: 1) the fact that all computing languages can generate pseudo-random numbers from the uniform distribution over the interval [0, 1] and 2) the fact that the CDF of <span class="math inline">\(X\)</span> (and other random variables generally) is a function that maps the support of <span class="math inline">\(X\)</span> to probabilities between zero and one.</p>
<ol type="a">
<li><p>First, find the inverse of CDF <span class="math inline">\(F_X\)</span> which you found in Question 1. This function, denoted <span class="math inline">\(F_X^{-1}\)</span> or <span class="math inline">\(Q\)</span>, is called the quantile function. The quantile function of a random variable specifies the value of a random variable such that the probability of the variable being less than or equal to that value equals the given quantile.</p></li>
<li><p>Generate 10,000 draws from a standard uniform distribution. These values can be thought of as probabilities. Plug these values into the function <span class="math inline">\(Q\)</span> that you just derived. By doing so, you generate a sample of size 10,000 from the random variable <span class="math inline">\(X\)</span> as specified in Question 1.</p></li>
<li><p>Verify your answers to Questions 1b and 1d by estimating <span class="math inline">\(E[X]\)</span> and <span class="math inline">\(P(X &gt; 0)\)</span>. Be sure to set your seed to <code>02138</code>.</p></li>
</ol>
</section>
<section id="question-3-20-points" class="level2">
<h2 class="anchored" data-anchor-id="question-3-20-points">Question 3 (20 points)</h2>
<p>Suppose <span class="math inline">\(X \sim \text{Pois}(\lambda)\)</span>, where <span class="math inline">\(\lambda\)</span> is fixed but unknown.</p>
<p>An estimator is a function of the data and the <strong>bias</strong> of an estimator, <span class="math inline">\(f(X)\)</span>, is defined as <span class="math inline">\(E[f(X)] - \theta\)</span>, where <span class="math inline">\(\theta\)</span> is the <strong>estimand</strong> (an unknown quantity we would like to estimate from the observable data).</p>
<p>For instance our estimand could be <span class="math inline">\(\lambda\)</span>, and we know by the properties of a Poisson random variable that the bias of the estimator, <span class="math inline">\(f(X) = X\)</span>, is <span class="math inline">\(E[X] - \lambda = \lambda - \lambda = 0\)</span>. We call an estimator with <span class="math inline">\(0\)</span> bias an <strong>unbiased</strong> estimator.</p>
<p>For this question, suppose that our estimand is <span class="math inline">\(\lambda^3\)</span> rather than <span class="math inline">\(\lambda\)</span>.</p>
<ol type="a">
<li>Show that <span class="math inline">\(X^3\)</span> is <em>not</em> an unbiased estimator of <span class="math inline">\(\lambda^3\)</span> and specify the bias as a function of <span class="math inline">\(\lambda\)</span>.</li>
</ol>
<p>Hints:</p>
<ol type="1">
<li><p>You may use the following result: if <span class="math inline">\(X \sim \text{Pois}(\lambda)\)</span>, then <span class="math inline">\(E[X\cdot g(X)] = \lambda E[g(X + 1)]\)</span> for any function <span class="math inline">\(g(\cdot)\)</span>.</p></li>
<li><p>You may use the result for <span class="math inline">\(E[X^2]\)</span> derived in lecture and section, (i.e., no need to derive it again).</p></li>
</ol>
<ol start="2" type="a">
<li>Suppose <span class="math inline">\(\lambda = 5\)</span>. Use <span class="math inline">\(150,000\)</span> simulations to validate your result to part (a). That is, calculate the bias of you estimator from both the simulations and the analytical results. Print your results in the format below:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">02138</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulation result </span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Analytical result </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="question-4-fishers-method-in-forecasting-30-points" class="level2">
<h2 class="anchored" data-anchor-id="question-4-fishers-method-in-forecasting-30-points">Question 4: Fisher’s method in forecasting (30 points)</h2>
<p>In this problem, we’re going to explore a real-world example of Fisher’s “lady tasting tea” experiment from lecture: election forecasters – who have, for better or worse, become a big part of politics in the United States and elsewhere. Be sure to set your seed: <code>set.seed(02138)</code>.</p>
<ol type="a">
<li>Suppose that Bob has correctly predicted six of the last eight election outcomes. What is the probability that someone randomly flipping a coin each of the same elections would have experienced the same success as Bob? Use <code>R</code> to compute your answer analytically (i.e.&nbsp;not by simulation).</li>
</ol>
<p>Forecasting has become so popular that riffraff are flooding the market. These “uniform amateurs” predict the vote share for each state in the U.S. presidential election by drawing a uniform random variable between 0 and 1, independently across states. You are deciding whether or not to hire a forecaster, Nate, to to forecast each of the 50 state election winners in the 2024 presidential general election based on the performance of his 2020 election forecast, but you are worried that Nate might be one of these amateurs. When you ask him to justify his 2020 forecasts, he says “my highest predicted [Democratic] vote share was 0.8 which is very unlikely if I were a uniform amateur.” Let’s evaluate his claim.</p>
<ol start="2" type="a">
<li><p>Suppose Nate is a uniform amateur and let <span class="math inline">\(X\)</span> be the maximum of the 51 uniform vote share draws (include D.C.). Derive the CDF and PDF of <span class="math inline">\(X\)</span>. Use these to calculate the probability of Nate’s highest Democratic vote share being 0.8 or less if he were a uniform amateur.</p></li>
<li><p>To be on the lookout for more uniform amateurs, it’s helpful to know what highest vote share we should expect. To that end, calculate <span class="math inline">\(E[X]\)</span>.</p></li>
</ol>
</section>
<section id="question-5-6-points" class="level2">
<h2 class="anchored" data-anchor-id="question-5-6-points">Question 5 (6 points)</h2>
<p>Let <span class="math inline">\(Z \sim \mathcal{N}(0, 1)\)</span>. Express the random variable <span class="math inline">\(Y \sim \mathcal{N}(1, 4)\)</span> as a simple function in terms of <span class="math inline">\(Z\)</span>. Make sure to check that your <span class="math inline">\(Y\)</span> has the correct mean and variance.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>